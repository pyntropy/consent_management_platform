# Согласия

## Обоснование

Для взаимодействия с клиентом, оказания услуг клиенту компанией
и ее партнерами необходимо получить согласие (_consent_) клиента
на обработку персональных данных (ПДн).

Процесс сбора согласия состоит из:
- составления текста согласия и сохранение его в базе данных шаблонов (БД);
- заполнения согласия данными клиента;
- предоставления согласия на подпись клиенту: рукописную или ПЭП;
- фиксации факта согласия в системах учета и сохранения подписанного документа;
- передачи согласия внутренним потребителям.
- вывода клиенту список принятых согласий.

## Атрибуты согласий
По типу:
- **постояннные** (_standing_), обязательные согласие # TODO
- **ситуативные** (_instant_), например на получение рекламных расылок может показываться во многих   

По обязательности:
- **обязательные** (_mandatory_), например, для начала предоставления услуг.
- **не обязательные** (_voluntary_), например, на получение рекламных рассылок.

По содержанию:
- **фиксированные** (_fixed_) — не заполняются данными клиента. Один вид документа для каждого клиента.
- **переменные** (_variable_) — заполняются данными клиента. Каждый документ уникален.

Примеры:
- Согласие на рекламу: ситуативное, не обязательное, фиксированное.
- Согласие на обработку ПДн: ситуативное, обязательное, переменное.
- 

## Структура согласий и сборок

Сбор согласий выполняется в рамках сборки (bundle).
Одна сборка может содержать одно или несколько согласий.
Одно согласие может входить в разные сборки.

Каждая сборка имеет идентификатор типа UUID и название (_title_).
Название каждой сборки уникальное.

Каждой сборке соответствует уникальный набор атрибутов (_attr_set_) записанных в виде пар ключ-значение.
Атрибуты сборок позволяют сопоставить одному продукту разные сборки, и, как следствие, разные согласия
для разных бизнес-событий или одному бизнес-событию разные сборки.

Пример разных сборок для одного продукта и разных событий:
- { "event" = "subscribing", "product_id" = "auto" }
- { "event" = "activate", "product_id" = "auto" }

Пример разных сборок для одного события:
- { "event" = "purchase", "product_id" = "health", relation = "self" }
- { "event" = "purchase", "product_id" = "health", relation = "other" }


Таким образом сборка согласий идентифицируется через:
- название — человеком, для администрирования;
- атрибуты — системой, через исходные состояния процесса, для взаимодейтвия по идентификатору;
- идентификатор — системой.



Атрибуты 

## Процесс сбора

В процесссе сбора 

Согласие и шаблон разные сущности,
потому что шаблона может не быть.


Чтобы клиент дал согласие, ему надо дать документы на подпись.
Чтобы дать клиенту документы на подпись, надо получить его перс данные.

Перс данные в системе учета могут быть полные.
Перс данные в системе учета могут быть не полные.


Мастер система по полису, после создания полиса отправляет запрос в СПС.

Ожидаемый результат:
- если есть все данные, то печатные формы поставлены в очередь.
- после формировнания печатные формы помещаются в Documentum
- после размещаются в PEP-Service
- если данных нет, то печатные формы поставлены на draft


Клиент входит в канал сбора согласий