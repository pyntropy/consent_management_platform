# Согласия

## Обоснование

Для взаимодействия с клиентом, оказания услуг клиенту компанией
и ее партнерами необходимо получить согласие (_consent_) клиента
на обработку персональных данных (ПДн).

Процесс сбора согласия состоит из:
- составления текста согласия и сохранение его в базе данных шаблонов (БД);
- (опционально) заполнения согласия данными клиента;
- (опционально) предоставления согласия на подпись клиенту: рукописную или ПЭП;
- фиксации факта согласия в системах учета
- (опционально) сохранения подписанного документа;
- передачи согласия внутренним потребителям.
- вывода клиенту список принятых согласий.

## Атрибуты согласий
По обязательности:
- **обязательные** (_man., mandatory_), например, для начала предоставления услуг.
- **не обязательные** (_vol., voluntary_), например, на получение рекламных рассылок.

По содержанию:
- **фиксированные** (_fix., fixed_) — не заполняются данными клиента. Один вид документа для каждого клиента.
- **переменные** (_var., variable_) — заполняются данными клиента. Каждый документ уникален.

По типу: ИЛИ ЭТО СБОРКИ ?
- **планируемые** (_stg., staging_) — ожидаемые по процессу. **КРИВО** инициируется мастер-системой
- **ситуативные** (_ins., instant_) — ожидаемые по событию. **КРИВО** инициируется каналом


Примеры:
- Согласие на рекламу: не обязательное, фиксированное, ситуативное.
- Согласие на обработку ПДн: обязательное, переменное.
- 

## Структура согласий и сборок

Сбор согласий выполняется в рамках сборки (bundle).
Одна сборка может содержать одно или несколько согласий.
Одно согласие может входить в разные сборки.

Каждая сборка имеет идентификатор типа UUID и название (_title_).
Название каждой сборки уникальное.

Каждой сборке соответствует уникальный набор атрибутов (_attr_set_) записанных в виде пар ключ-значение.
Атрибуты сборок позволяют сопоставить одному продукту разные сборки, и, как следствие, разные согласия
для разных бизнес-событий или одному бизнес-событию разные сборки.

Пример разных сборок для одного продукта и разных событий:
- { "event" = "subscribing", "product_id" = "auto" }
- { "event" = "activate", "product_id" = "auto" }

Пример разных сборок для одного события:
- { "event" = "purchase", "product_id" = "health", "relation" = "self" }
- { "event" = "purchase", "product_id" = "health", "relation" = "other" }

Таким образом сборка согласий идентифицируется через:
- название — человеком, для администрирования;
- атрибуты — системой, через исходные состояния процесса, для взаимодейтвия по идентификатору;
- идентификатор — системой.

## Процесс сбора

Сбор согласий осуществляется в каналах сбора согласий.

Есть два варианта:
- сборка согласий планируемая (_stg_)
- сборка согласий ситуативная (_ins_)





Согласие и шаблон разные сущности,
потому что шаблона может не быть.


Чтобы клиент дал согласие, ему надо дать документы на подпись.
Чтобы дать клиенту документы на подпись, надо получить его перс данные.

Перс данные в системе учета могут быть полные.
Перс данные в системе учета могут быть не полные.


Мастер система по полису, после создания полиса отправляет запрос в СПС.

Ожидаемый результат:
- если есть все данные, то печатные формы поставлены в очередь.
- после формировнания печатные формы помещаются в Documentum
- после размещаются в PEP-Service
- если данных нет, то печатные формы поставлены на draft


Клиент входит в канал сбора согласий